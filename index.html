<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Test Firebase Login</title>
  <script>
    window.firebaseConfig = {
      apiKey: "AIzaSyBRGM431CHZ3UMUHIc4Q-S1aGDMfrbu7Gs",
      authDomain: "ican-kit-prep.firebaseapp.com",
      projectId: "ican-kit-prep",
      storageBucket: "ican-kit-prep.firebasestorage.app",
      messagingSenderId: "354385037521",
      appId: "1:354385037521:web:f3a7265f66983942581df0",
      measurementId: "G-LN8E2R4B7X"
    };
  </script>
  <script src="./assets/firebase.js"></script>
</head>
<body>
  <button id="btnGoogle">Login with Google</button>
  <div id="status">Not signed in</div>

  <script>
    (async () => {
      const btn = document.getElementById("btnGoogle");
      const status = document.getElementById("status");

      // wait for firebase bootstrap
      let tries=0;
      while (!window.AppSignIn && tries<30) {
        await new Promise(r=>setTimeout(r,200));
        tries++;
      }

      if (!window.AppSignIn) {
        status.textContent = "Auth never initialized";
        return;
      }

      btn.onclick = () => {
        window.AppSignIn()
          .then(u => console.log("Signed in:", u))
          .catch(e => console.error("Error:", e));
      };

      window.AppOnAuthChanged(window.AppAuth, user=>{
        status.textContent = user ? `Signed in as ${user.email}` : "Not signed in";
      });
    })();
  </script>
</body>
</html>
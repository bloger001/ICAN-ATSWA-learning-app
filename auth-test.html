<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Test Firebase Login</title>
</head>
<body>
  <h3>Test Firebase Login</h3>
  <p id="log">Loading…</p>
  <button id="btn" disabled>Login with Google</button>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>

  <!-- Your project config (from Firebase console) -->
  <script>
  window.firebaseConfig = {
    apiKey: "AIzaSyBRGM431CHZ3UMUHIc4Q-S1aGDMfrbu7Gs",
    authDomain: "ican-kit-prep.firebaseapp.com",
    projectId: "ican-kit-prep",
    storageBucket: "ican-kit-prep.firebasestorage.app",
    messagingSenderId: "354385037521",
    appId: "1:354385037521:web:f3a7265f66983942581df0",
    measurementId: "G-LN8E2R4B7X"
  };
  </script>

  <script>
  const log = (m) => (document.getElementById('log').innerText = m);

  try {
    if (!window.firebase || !firebase.initializeApp) {
      log("❌ Firebase SDK not loaded");
    } else if (!window.firebaseConfig) {
      log("❌ Config missing");
    } else {
      const app = firebase.apps.length ? firebase.app() : firebase.initializeApp(window.firebaseConfig);
      const auth = firebase.auth();
      const provider = new firebase.auth.GoogleAuthProvider();

      log("✅ SDK loaded, init OK. Waiting for auth state…");
      document.getElementById('btn').disabled = false;

      document.getElementById('btn').onclick = async () => {
        try {
          await auth.signInWithPopup(provider);
        } catch (e) {
          // If popup blocked, try redirect
          try { await auth.signInWithRedirect(provider); }
          catch (e2) { log("❌ Sign-in error: " + e2.message); }
        }
      };

      auth.onAuthStateChanged((user) => {
        if (user) {
          log("✅ Signed in as: " + (user.email || user.uid));
        } else {
          log("ℹ️ Not signed in");
        }
      });
    }
  } catch (e) {
    log("❌ Init crash: " + e.message);
  }
  </script>
</body>
</html>